<!DOCTYPE html>
<html class="no-js">
	<head>
		<meta charset="utf-8">
		<title>Speed Up NPM INSTALL on Visual Studio Team Services — AKJ.IO</title>
		<meta name="description" content="A website from Allan Kimmer Jensen, mostly about being awesome. Granted there are posts about web development.">
		<meta name="viewport" content="width=device-width, initial-scale=1">

		

		<link href='https://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic' rel='stylesheet' type='text/css'>

		<!-- build:css /styles/main.css -->
		<link rel="stylesheet" href="/styles/main.css">
		<!-- endbuild -->

		<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/default.min.css">

		<!-- build:js /scripts/vendor/modernizr.js -->
		<!-- endbuild -->

		
		
	</head>
	<body>
		<header class="header">
			<nav class="container">
				<h3>AKJ.IO<span class="by">Allan Kimmer Jensen</span></h3>
				<ul class="menu">
					<li class="menu__item menu__item--active">
						<a class="menu__item__link" href="/">Blog <span class="menu__item__link__description">Internet Adventures</span></a>
					</li>
					<li class="menu__item">
						<a class="menu__item__link" href="/about-me/">About Me <span class="menu__item__link__description">Stats, Level and Skills!</span></a>
					</li>
					<li class="menu__item">
						<a class="menu__item__link" href="/labs/">Labs <span class="menu__item__link__description">Insane Experiments</span></a>
					</li>
				</ul>
			</nav>
		</header>
		
		
		<main>
			
	<article class="article">
		
		<div class="article__content">
			<header class="article__header">
				<h1 itemprop="headline">Speed Up NPM INSTALL on Visual Studio Team Services</h1>
				<h3>Tired of your build times are mega slow due to npm?</h3>
				<div class="article__header__metadata">
					<time itemprop="datePublished" datetime="20 April 2017"><span class="glyphicon glyphicon-time" aria-hidden="true"></span>20 April 2017</time>
				</div>
			</header>

			<p>My NPM build times were slow. The npm task alone were taking 75% of the totalt build time. I felt that this was too much so I investigated it a bit more.<br>It turns out I&#39;m not the only one having issues.</p>
<h2 id="solution-1-run-your-own-build-agent">Solution 1: Run your own build agent</h2>
<p>Now you could run your own build agent and cache all of the modules there, however if you are like me using Hosted agents, this is not an option.   </p>
<h2 id="solution-2-wait-for-microsoft-to-fix-their-things">Solution 2: Wait for Microsoft to fix their things</h2>
<p>There are multiple issues regarding this on the different platforms, like this one <a href="https://github.com/Microsoft/vsts-tasks/issues/553">https://github.com/Microsoft/vsts-tasks/issues/553</a> on github.<br>However the solutions mostly rely on you having an Agent yourself, or on Microsoft doing internal caching for their Hosted network.   </p>
<h2 id="solution-3-replace-npm-with-yarn-on-vsts">Solution 3: Replace npm with Yarn on VSTS</h2>
<p>But one things remains, and that&#39;s what I did <a href="https://marketplace.visualstudio.com/items?itemName=geeklearningio.gl-vsts-tasks-yarn">Install Yarn for VSTS</a>.<br>This enables you to use <a href="https://yarnpkg.com/">Yarn</a> instead of NPM, this should give some speed boosts.</p>
<p>Installing dependencies:</p>
<ul>
<li>NPM: 198 seconds</li>
<li>YARN: 56 seconds</li>
</ul>
<p>Full build:</p>
<ul>
<li>With NPM: 264 seconds</li>
<li>With YARN: 112 seconds</li>
</ul>
<p>This is a considerable speed up for my builds, and a very easy one as well.<br>Just replace the <code>npm install</code> task on VSTS with <code>Yarn</code> and you are finished, nothing else needs to be done.</p>
<p>This will work for most projects, on other CI-servies, but some have already cached the modules making your builds faster.<br>Until Microsoft adds this, this is a great improvement.</p>


			<footer class="article__footer">
				<a itemprop="discussionUrl" href="#">Show comments...</a>
<div id="disqus_thread"></div>
<script type="text/javascript">
	var showComments = document.querySelector('[itemprop="discussionUrl"]');

	showComments.addEventListener('click', function(e) {
		e.preventDefault();
		/* * * CONFIGURATION VARIABLES * * */
	    var disqus_shortname = 'akj';

	    /* * * DON'T EDIT BELOW THIS LINE * * */
	    (function() {
	        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
	        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
	        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	    })();
	});
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

			</footer>
		</div>
	</article>

			<div class="footer">
				<p>© 2017 Allan Kimmer Jensen</p>
			</div>

			
		</main>

		<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};
ga('create', 'UA-16106069-1', 'auto');
ga('set', 'transport', 'beacon');
ga('send', 'pageview');
</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>


		<!-- build:js /scripts/main.js -->
		<!-- <script src="/scripts/main.js"></script> -->
		<!-- endbuild -->

		<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js"></script>
		<script>hljs.initHighlightingOnLoad();</script>
	</body>
</html>
